<?xml version="1.0" encoding="utf-8"?>
<addon addon_id="SV_UserActivity" title="Basic User Activity" version_string="1.4.0" version_id="1040000" url="" install_callback_class="SV_UserActivity_Installer" install_callback_method="install" uninstall_callback_class="SV_UserActivity_Installer" uninstall_callback_method="uninstall">
  <admin_navigation/>
  <admin_permissions/>
  <admin_style_properties/>
  <admin_templates/>
  <admin_template_modifications/>
  <code_events/>
  <code_event_listeners>
    <listener event_id="load_class_controller" execute_order="10" callback_class="SV_UserActivity_Listener" callback_method="load_class" active="1" hint="NixFifty_Calendar_ControllerPublic_Calendar" description="NixFifty_Calendar_ControllerPublic_Calendar"/>
    <listener event_id="load_class_controller" execute_order="3178" callback_class="SV_UserActivity_Listener" callback_method="load_class" active="1" hint="XenForo_ControllerPublic_Thread" description="XenForo_ControllerPublic_Thread"/>
    <listener event_id="load_class_controller" execute_order="3178" callback_class="SV_UserActivity_Listener" callback_method="load_class" active="1" hint="XenForo_ControllerPublic_Post" description="XenForo_ControllerPublic_Post"/>
    <listener event_id="load_class_controller" execute_order="3178" callback_class="SV_UserActivity_Listener" callback_method="load_class" active="1" hint="XenForo_ControllerPublic_Conversation" description="XenForo_ControllerPublic_Conversation"/>
    <listener event_id="load_class_controller" execute_order="3178" callback_class="SV_UserActivity_Listener" callback_method="load_class" active="1" hint="NixFifty_Tickets_ControllerPublic_Ticket" description="NixFifty_Tickets_ControllerPublic_Ticket"/>
    <listener event_id="load_class_controller" execute_order="31780" callback_class="SV_UserActivity_Listener" callback_method="load_class" active="1" hint="XenForo_ControllerPublic_Report" description="XenForo_ControllerPublic_Report"/>
    <listener event_id="load_class_model" execute_order="3178" callback_class="SV_UserActivity_Listener" callback_method="load_class" active="1" hint="XenForo_Model_User" description="XenForo_Model_User"/>
  </code_event_listeners>
  <cron>
    <entry entry_id="SV_UserActivity_GC" cron_class="SV_UserActivity_CronEntry_ActivityGarbageCollect" cron_method="run" active="1"><![CDATA[{"day_type":"dom","dom":["-1"],"hours":["-1"],"minutes":["0","5","10","15","20","25","30","35","40","45","50","55"]}]]></entry>
  </cron>
  <email_templates/>
  <email_template_modifications/>
  <optiongroups>
    <group group_id="RainDD_UA_Options" display_order="12630" debug_only="0"/>
    <option option_id="RainDD_UA_ThreadViewPos" edit_format="select" data_type="integer" can_backup="1">
      <default_value>3</default_value>
      <edit_format_params>0={xen:phrase RainDD_UA_Disabled}
1={xen:phrase RainDD_UA_PositionAbovePageNav}
2={xen:phrase RainDD_UA_PositionAboveQR}
3={xen:phrase RainDD_UA_PositionBelowQR}</edit_format_params>
      <sub_options></sub_options>
      <relation group_id="RainDD_UA_Options" display_order="100"/>
    </option>
    <option option_id="RainDD_UA_ThreadViewType" edit_format="radio" data_type="integer" can_backup="1">
      <default_value>0</default_value>
      <edit_format_params>0={xen:phrase RainDD_UA_DisplayName}
1={xen:phrase RainDD_UA_DisplayAvatar}</edit_format_params>
      <sub_options></sub_options>
      <relation group_id="RainDD_UA_Options" display_order="120"/>
    </option>
    <option option_id="SV_UA_Cutoff" edit_format="spinbox" data_type="integer" can_backup="1">
      <default_value>250</default_value>
      <edit_format_params></edit_format_params>
      <sub_options></sub_options>
      <relation group_id="RainDD_UA_Options" display_order="130"/>
    </option>
    <option option_id="SV_UA_TrackRobots" edit_format="onoff" data_type="boolean" can_backup="1">
      <default_value>0</default_value>
      <edit_format_params></edit_format_params>
      <sub_options></sub_options>
      <relation group_id="RainDD_UA_Options" display_order="10"/>
    </option>
    <option option_id="UA_fillFactor" edit_format="textbox" data_type="unsigned_numeric" can_backup="1">
      <default_value>1.2</default_value>
      <edit_format_params></edit_format_params>
      <sub_options></sub_options>
      <relation group_id="RainDD_UA_Options" display_order="30"/>
    </option>
    <option option_id="UA_pruneChance" edit_format="textbox" data_type="unsigned_numeric" can_backup="1">
      <default_value>0.1</default_value>
      <edit_format_params></edit_format_params>
      <sub_options></sub_options>
      <relation group_id="RainDD_UA_Options" display_order="20"/>
    </option>
  </optiongroups>
  <permissions>
    <permission_groups>
      <permission_group permission_group_id="RainDD_UA_PermissionsMain"/>
    </permission_groups>
    <permissions>
      <permission permission_group_id="RainDD_UA_PermissionsMain" permission_id="RainDD_UA_ThreadViewers" permission_type="flag" default_value="unset" interface_group_id="raindd_ua_pigm" display_order="10"/>
    </permissions>
    <interface_groups>
      <interface_group interface_group_id="raindd_ua_pigm" display_order="12030"/>
    </interface_groups>
  </permissions>
  <phrases>
    <phrase title="cron_entry_SV_UserActivity_GC" version_id="1000000" version_string="1.0.0"><![CDATA[User Activity Cleanup]]></phrase>
    <phrase title="option_group_RainDD_UA_Options" version_id="1000000" version_string="1.0.0"><![CDATA[User Activity]]></phrase>
    <phrase title="option_group_RainDD_UA_Options_description" version_id="1000000" version_string="1.0.0"><![CDATA[]]></phrase>
    <phrase title="option_RainDD_UA_ThreadViewPos" version_id="1000000" version_string="1.0.0"><![CDATA[Viewing Thread Container Position]]></phrase>
    <phrase title="option_RainDD_UA_ThreadViewPos_explain" version_id="1000000" version_string="1.0.0"><![CDATA[Enable and choose where in the thread view the container for Viewing Thread will appear.]]></phrase>
    <phrase title="option_RainDD_UA_ThreadViewType" version_id="1000000" version_string="1.0.0"><![CDATA[Viewing Thread Display Type]]></phrase>
    <phrase title="option_RainDD_UA_ThreadViewType_explain" version_id="1000000" version_string="1.0.0"><![CDATA[Display users name or avatar for users Viewing Thread.]]></phrase>
    <phrase title="option_SV_UA_Cutoff" version_id="1000007" version_string="1.0.0 Alpha 7"><![CDATA[User cutoff]]></phrase>
    <phrase title="option_SV_UA_Cutoff_explain" version_id="1000007" version_string="1.0.0 Alpha 7"><![CDATA[Maximum number of users to display before it is displays as "...and X others".<br/>
0 to show all usernames always.]]></phrase>
    <phrase title="option_SV_UA_TrackRobots" version_id="1000000" version_string="1.0.0"><![CDATA[Track Robots]]></phrase>
    <phrase title="option_SV_UA_TrackRobots_explain" version_id="1000000" version_string="1.0.0"><![CDATA[Show/Hid robots from user activity]]></phrase>
    <phrase title="option_UA_fillFactor" version_id="1000004" version_string="1.0.0 Alpha4"><![CDATA[Fill Factor]]></phrase>
    <phrase title="option_UA_fillFactor_explain" version_id="1000004" version_string="1.0.0 Alpha4"><![CDATA[When doing a prune operation, the number of inactive users must be greater than active users times this fill factor.]]></phrase>
    <phrase title="option_UA_pruneChance" version_id="1000004" version_string="1.0.0 Alpha4"><![CDATA[Prune Chance]]></phrase>
    <phrase title="option_UA_pruneChance_explain" version_id="1000004" version_string="1.0.0 Alpha4"><![CDATA[When the list of active users per content type is returned, this is the probability that a prune operation will be considered.]]></phrase>
    <phrase title="permission_group_RainDD_UA_PermissionsMain" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[[RainDD] User Activity Permissions]]></phrase>
    <phrase title="permission_interface_raindd_ua_pigm" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[[RainDD] User Activity Permissions]]></phrase>
    <phrase title="permission_RainDD_UA_PermissionsMain_RainDD_UA_ThreadViewers" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[Can view users who are viewing thread]]></phrase>
    <phrase title="RainDD_UA_Disabled" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[Disabled]]></phrase>
    <phrase title="RainDD_UA_DisplayAvatar" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[Avatar]]></phrase>
    <phrase title="RainDD_UA_DisplayName" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[Username]]></phrase>
    <phrase title="RainDD_UA_PositionAbovePageNav" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[Above PageNav]]></phrase>
    <phrase title="RainDD_UA_PositionAboveQR" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[Above Quick Reply]]></phrase>
    <phrase title="RainDD_UA_PositionBelowQR" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[Below Quick Reply]]></phrase>
    <phrase title="style_property_group_raindd_ua_main_master" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[[RainDD] User Activity]]></phrase>
    <phrase title="style_property_group_raindd_ua_main_master_desc" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[]]></phrase>
    <phrase title="style_property_RainDD_UA_Avatar_description_master" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[]]></phrase>
    <phrase title="style_property_RainDD_UA_Avatar_master" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[Thread Avatar]]></phrase>
    <phrase title="style_property_RainDD_UA_ThreadContainerH3Footnote_description_master" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[Adjust font properties for user and guest counts.]]></phrase>
    <phrase title="style_property_RainDD_UA_ThreadContainerH3Footnote_master" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[Thread Container Counts]]></phrase>
    <phrase title="style_property_RainDD_UA_ThreadContainerH3_description_master" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[Adjust container title font and border.]]></phrase>
    <phrase title="style_property_RainDD_UA_ThreadContainerH3_master" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[Thread Container Title]]></phrase>
    <phrase title="style_property_RainDD_UA_ThreadContainer_description_master" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[Adjust container properties such as background, border, and default font size.]]></phrase>
    <phrase title="style_property_RainDD_UA_ThreadContainer_master" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[Thread Container]]></phrase>
    <phrase title="UA_ViewingTitle" version_id="1000004" version_string="1.0.0 Alpha4"><![CDATA[Users Who Are Viewing This {ContentType} <span class="footnote">(Users: {users}, Guests: {guests})</span>]]></phrase>
  </phrases>
  <route_prefixes/>
  <style_properties>
    <property property_name="RainDD_UA_ThreadContainer" property_type="css" definition="1" group_name="raindd_ua_main" title="Thread Container" description="Adjust container properties such as background, border, and default font size." css_components="text,background,border,layout,extra" scalar_type="" scalar_parameters="" display_order="10" sub_group=""><![CDATA[[]]]></property>
    <property property_name="RainDD_UA_Avatar" property_type="css" definition="1" group_name="raindd_ua_main" title="Thread Avatar" description="" css_components="layout" scalar_type="" scalar_parameters="" display_order="40" sub_group=""><![CDATA[[]]]></property>
    <property property_name="RainDD_UA_ThreadContainerH3" property_type="css" definition="1" group_name="raindd_ua_main" title="Thread Container Title" description="Adjust container title font and border." css_components="text,border,layout,extra" scalar_type="" scalar_parameters="" display_order="20" sub_group=""><![CDATA[{"border-bottom-color":"@primaryLighterStill","border-bottom-style":"solid","border-bottom-width":"1px","color":"@primaryLight","font-size":"12pt","margin-bottom":"5px","padding-bottom":"2px"}]]></property>
    <property property_name="RainDD_UA_ThreadContainerH3Footnote" property_type="css" definition="1" group_name="raindd_ua_main" title="Thread Container Counts" description="Adjust font properties for user and guest counts." css_components="text,layout,extra" scalar_type="" scalar_parameters="" display_order="30" sub_group=""><![CDATA[{"color":"@primaryLight","font-size":"12px","margin-top":"5px"}]]></property>
    <group group_name="raindd_ua_main" display_order="20030">
      <title>User Activity</title>
      <description></description>
    </group>
  </style_properties>
  <templates>
    <template title="RainDD_UA_Thread.css" version_id="1010031" version_string="1.1.0 Beta 1"><![CDATA[#uaThreadViewContainer,
#uaThreadReadContainer
{
	{xen:property RainDD_UA_ThreadContainer}
}

#uaThreadViewContainer h3,
#uaThreadReadContainer h3
{
	{xen:property RainDD_UA_ThreadContainerH3}
}

#uaThreadViewContainer h3 .footnote,
#uaThreadReadContainer h3 .footnote
{
	{xen:property RainDD_UA_ThreadContainerH3Footnote}
}

#uaThreadViewContainer .avatar img,
#uaThreadReadContainer .avatar img
{
	{xen:property RainDD_UA_Avatar}
}]]></template>
    <template title="RainDD_UA_ThreadViewContainer" version_id="1000007" version_string="1.0.0 Alpha 7"><![CDATA[<xen:if is="{$UA_ViewerPermission}">
	<xen:if hascontent="true">
	<xen:require css="RainDD_UA_Thread.css" />
	<div id="uaThreadViewContainer" class="section secondaryContent">
		<h3>{xen:phrase UA_ViewingTitle, 'ContentType={$UA_ContentType}', 'users={xen:number $UA_UsersViewing.members}', 'guests={xen:number $UA_UsersViewing.guests}'}</h3>
		<xen:if is="{$xenOptions.RainDD_UA_ThreadViewType} == 0">
			<ol class="listInline commaImplode">
		<xen:elseif is="{$xenOptions.RainDD_UA_ThreadViewType} == 1" />
			<ol class="listInline">
		</xen:if>
			<xen:contentcheck>
			<xen:if is="{$xenOptions.RainDD_UA_ThreadViewType} == 0">
			<xen:foreach loop="$UA_UsersViewing.records" value="$user">
				<li><xen:username user="$user" rich="true" title="{xen:phrase x_was_last_seen, 'username={$user.username}'}: {xen:datetime $user.effective_last_activity}"/></li>
			</xen:foreach>
			<xen:elseif is="{$xenOptions.RainDD_UA_ThreadViewType} == 1" />
			<xen:foreach loop="$UA_UsersViewing.records" value="$user">
				<li><xen:avatar user="$user" size="s" img="true" title="{xen:phrase x_was_last_seen, 'username={$user.username}'}: {xen:datetime $user.effective_last_activity}"/></li>
			</xen:foreach>
			</xen:if>
			<xen:if is="{$UA_UsersViewing.recordsUnseen}">
				<li class="moreLink">... {xen:phrase and_x_more, 'count={xen:number $UA_UsersViewing.recordsUnseen}'}</li>
			</xen:if>
			</xen:contentcheck>
			</ol>
		</div>
	</xen:if>
</xen:if>]]></template>
  </templates>
  <public_template_modifications>
    <modification template="conversation_view" modification_key="conversation_view_UA_Containers" description="Adds activity containers" execution_order="10" enabled="1" action="preg_replace">
      <find><![CDATA[#(<div class="pageNavLinkGroup">.*)(<xen:if is="{\$canReplyConversation}">\s*<xen:include template="quick_reply">.*?</xen:include>\s*</xen:if>)#si]]></find>
      <replace><![CDATA[<xen:if is="{$xenOptions.RainDD_UA_ThreadViewPos} == 1">
	<xen:include template="RainDD_UA_ThreadViewContainer" />
</xen:if>
$1
<xen:if is="{$xenOptions.RainDD_UA_ThreadViewPos} == 2">
	<xen:include template="RainDD_UA_ThreadViewContainer" />
</xen:if>
$2
<xen:if is="{$xenOptions.RainDD_UA_ThreadViewPos} == 3">
	<xen:include template="RainDD_UA_ThreadViewContainer" />
</xen:if>]]></replace>
    </modification>
    <modification template="nf_tickets_ticket_view" modification_key="nf_tickets_ticket_view_UA_Containers" description="Adds activity containers" execution_order="10" enabled="1" action="preg_replace">
      <find><![CDATA[#(<div class="pageNavLinkGroup">.*)(<xen:if is="{\$canQuickReply}">\s*<xen:include template="quick_reply">.*?</xen:include>\s*</xen:if>)#si]]></find>
      <replace><![CDATA[<xen:if is="{$xenOptions.RainDD_UA_ThreadViewPos} == 1">
	<xen:include template="RainDD_UA_ThreadViewContainer" />
</xen:if>
$1
<xen:if is="{$xenOptions.RainDD_UA_ThreadViewPos} == 2">
	<xen:include template="RainDD_UA_ThreadViewContainer" />
</xen:if>
$2
<xen:if is="{$xenOptions.RainDD_UA_ThreadViewPos} == 3">
	<xen:include template="RainDD_UA_ThreadViewContainer" />
</xen:if>]]></replace>
    </modification>
    <modification template="report_view" modification_key="report_view_UA_Containers" description="Adds activity containers" execution_order="10" enabled="1" action="preg_replace">
      <find><![CDATA[#(\s*)(<h3 class="subHeading">{xen:phrase content}</h3>.*?)(<h3 class="subHeading">{xen:phrase comments}</h3>.*?)(<li class="primaryContent">)#si]]></find>
      <replace><![CDATA[$1
<xen:if is="{$xenOptions.RainDD_UA_ThreadViewPos} == 1">
	<xen:include template="RainDD_UA_ThreadViewContainer" />
</xen:if>
$1$2
<xen:if is="{$xenOptions.RainDD_UA_ThreadViewPos} == 2">
	<xen:include template="RainDD_UA_ThreadViewContainer" />
</xen:if>
$1$3
<xen:if is="{$xenOptions.RainDD_UA_ThreadViewPos} == 3">
	<xen:include template="RainDD_UA_ThreadViewContainer" />
</xen:if>
$4]]></replace>
    </modification>
    <modification template="thread_view" modification_key="thread_view_UA_Containers" description="Adds activity containers" execution_order="10" enabled="1" action="preg_replace">
      <find><![CDATA[#(<div class="pageNavLinkGroup">.*)(<xen:if is="{\$canQuickReply}">\s*<xen:include template="quick_reply">.*?</xen:include>\s*</xen:if>)#si]]></find>
      <replace><![CDATA[<xen:if is="{$xenOptions.RainDD_UA_ThreadViewPos} == 1">
	<xen:include template="RainDD_UA_ThreadViewContainer" />
</xen:if>
$1
<xen:if is="{$xenOptions.RainDD_UA_ThreadViewPos} == 2">
	<xen:include template="RainDD_UA_ThreadViewContainer" />
</xen:if>
$2
<xen:if is="{$xenOptions.RainDD_UA_ThreadViewPos} == 3">
	<xen:include template="RainDD_UA_ThreadViewContainer" />
</xen:if>]]></replace>
    </modification>
  </public_template_modifications>
  <bb_code_media_sites/>
  <bb_codes/>
</addon>
